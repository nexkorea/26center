import{r as a,u as f,j as e,L as i}from"./index-qLvPICOV.js";import{s as r,L as N}from"./Logo26Building-D4GKwBS0.js";function w(){const[b,m]=a.useState(null),[d,x]=a.useState(null),[n,o]=a.useState([]),[u,h]=a.useState(!0),c=f();a.useEffect(()=>{g()},[]);const g=async()=>{try{const{data:{user:s}}=await r.auth.getUser();if(!s){c("/login");return}m(s);const{data:l}=await r.from("profiles").select("*").eq("id",s.id).single();l&&x(l);const{data:t}=await r.from("move_in_cards").select("*").eq("user_id",s.id).order("created_at",{ascending:!1});t&&o(t)}catch(s){console.error("Error:",s)}finally{h(!1)}},p=async()=>{await r.auth.signOut(),c("/")},j=s=>{const t={pending:{text:"검토중",class:"bg-yellow-100 text-yellow-800"},approved:{text:"승인됨",class:"bg-green-100 text-green-800"},rejected:{text:"반려됨",class:"bg-red-100 text-red-800"}}[s];return e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${t.class}`,children:t.text})};return u?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"로딩 중..."})]})}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("header",{className:"bg-white shadow",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex justify-between items-center py-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(i,{to:"/",className:"flex items-center",children:e.jsx(N,{size:40})}),e.jsx("span",{className:"ml-4 text-gray-600",children:"입주자 대시보드"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("span",{className:"text-gray-700",children:["안녕하세요, ",d?.name,"님"]}),e.jsx("button",{onClick:p,className:"bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-md text-sm font-medium cursor-pointer whitespace-nowrap",children:"로그아웃"})]})]})})}),e.jsx("main",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"px-4 py-6 sm:px-0",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"내 입주카드"}),e.jsxs(i,{to:"/move-in-card/new",className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md text-sm font-medium cursor-pointer whitespace-nowrap",children:[e.jsx("i",{className:"ri-add-line mr-2"}),"새 입주카드 작성"]})]}),n.length===0?e.jsxs("div",{className:"bg-white shadow rounded-lg p-6 text-center",children:[e.jsx("i",{className:"ri-file-list-3-line text-4xl text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"입주카드가 없습니다"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"첫 번째 입주카드를 작성해보세요."}),e.jsx(i,{to:"/move-in-card/new",className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md text-sm font-medium cursor-pointer whitespace-nowrap",children:"입주카드 작성하기"})]}):e.jsx("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:e.jsx("ul",{className:"divide-y divide-gray-200",children:n.map(s=>e.jsx("li",{children:e.jsx("div",{className:"px-4 py-4 sm:px-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-lg font-medium text-blue-600 truncate",children:s.company_name}),j(s.status)]}),e.jsxs("div",{className:"mt-2 sm:flex sm:justify-between",children:[e.jsxs("div",{className:"sm:flex",children:[e.jsxs("p",{className:"flex items-center text-sm text-gray-500",children:[e.jsx("i",{className:"ri-building-line mr-1"}),s.floor_number,"층 ",s.room_number,"호"]}),e.jsxs("p",{className:"mt-2 flex items-center text-sm text-gray-500 sm:mt-0 sm:ml-6",children:[e.jsx("i",{className:"ri-calendar-line mr-1"}),"입주일: ",new Date(s.move_in_date).toLocaleDateString("ko-KR")]})]}),e.jsxs("div",{className:"mt-2 flex items-center text-sm text-gray-500 sm:mt-0",children:[e.jsx("i",{className:"ri-time-line mr-1"}),"신청일: ",new Date(s.created_at).toLocaleDateString("ko-KR")]})]}),s.admin_notes&&e.jsx("div",{className:"mt-2 p-3 bg-gray-50 rounded-md",children:e.jsxs("p",{className:"text-sm text-gray-700",children:[e.jsx("strong",{children:"관리자 메모:"})," ",s.admin_notes]})})]}),e.jsx("div",{className:"ml-4 flex-shrink-0",children:e.jsx(i,{to:`/move-in-card/${s.id}`,className:"text-blue-600 hover:text-blue-500 cursor-pointer",children:e.jsx("i",{className:"ri-eye-line text-lg"})})})]})})},s.id))})})]})})]})}export{w as default};
