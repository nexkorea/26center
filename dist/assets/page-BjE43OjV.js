import{r as n,u as j,j as e,L as f}from"./index-mOjDVeg_.js";import{L as w,s as m}from"./Logo26Building--DCRkAWY.js";function k(){const[s,b]=n.useState({name:"",email:"",password:"",confirmPassword:"",phone:"",agreeTerms:!1}),[u,p]=n.useState(!1),[x,t]=n.useState(""),[h,d]=n.useState(""),g=j(),y=async i=>{if(i.preventDefault(),s.password!==s.confirmPassword){t("비밀번호가 일치하지 않습니다.");return}if(!s.agreeTerms){t("이용약관에 동의해주세요.");return}p(!0),t(""),d("");try{const{data:r,error:l}=await m.auth.signUp({email:s.email,password:s.password,options:{emailRedirectTo:`${window.location.origin}/dashboard`,data:{name:s.name,phone:s.phone}}});if(l)throw l;if(r.user){const{data:c}=await m.from("profiles").select("id").eq("id",r.user.id).single();if(!c){const{error:o}=await m.from("profiles").upsert({id:r.user.id,name:s.name,email:s.email,phone:s.phone,role:"user"},{onConflict:"id"});if(o&&!o.message.includes("duplicate key"))throw o}r.user.identities&&r.user.identities.length===0?d("회원가입이 완료되었습니다. 이메일을 확인하여 인증을 완료해주세요."):(d("회원가입이 완료되었습니다. 로그인 페이지로 이동합니다."),setTimeout(()=>g("/login"),2e3))}}catch(r){t(r.message||"회원가입에 실패했습니다.")}finally{p(!1)}},a=i=>{const{name:r,value:l,type:c,checked:o}=i.target;b({...s,[r]:c==="checkbox"?o:l})};return e.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:[e.jsx(f,{to:"/",className:"flex justify-center",children:e.jsx(w,{size:48})}),e.jsx("h2",{className:"mt-6 text-center text-3xl font-bold text-gray-900",children:"회원가입"}),e.jsxs("p",{className:"mt-2 text-center text-sm text-gray-600",children:["이미 계정이 있으신가요?"," ",e.jsx(f,{to:"/login",className:"font-medium text-blue-600 hover:text-blue-500 cursor-pointer",children:"로그인하기"})]})]}),e.jsx("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:e.jsxs("div",{className:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10",children:[x&&e.jsx("div",{className:"mb-4 bg-red-50 border border-red-200 text-red-600 px-4 py-3 rounded-md text-sm",children:x}),h&&e.jsx("div",{className:"mb-4 bg-green-50 border border-green-200 text-green-600 px-4 py-3 rounded-md text-sm",children:h}),e.jsxs("form",{className:"space-y-6",onSubmit:y,children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"이름"}),e.jsx("div",{className:"mt-1",children:e.jsx("input",{id:"name",name:"name",type:"text",required:!0,value:s.name,onChange:a,className:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm",placeholder:"이름을 입력하세요"})})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"이메일 주소"}),e.jsx("div",{className:"mt-1",children:e.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:s.email,onChange:a,className:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm",placeholder:"이메일을 입력하세요"})})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700",children:"전화번호"}),e.jsx("div",{className:"mt-1",children:e.jsx("input",{id:"phone",name:"phone",type:"tel",required:!0,value:s.phone,onChange:a,className:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm",placeholder:"전화번호를 입력하세요"})})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"비밀번호"}),e.jsx("div",{className:"mt-1",children:e.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"new-password",required:!0,value:s.password,onChange:a,className:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm",placeholder:"비밀번호를 입력하세요"})})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700",children:"비밀번호 확인"}),e.jsx("div",{className:"mt-1",children:e.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:"password",autoComplete:"new-password",required:!0,value:s.confirmPassword,onChange:a,className:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm",placeholder:"비밀번호를 다시 입력하세요"})})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{id:"agreeTerms",name:"agreeTerms",type:"checkbox",required:!0,checked:s.agreeTerms,onChange:a,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded cursor-pointer"}),e.jsxs("label",{htmlFor:"agreeTerms",className:"ml-2 block text-sm text-gray-900 cursor-pointer",children:[e.jsx("a",{href:"#",className:"text-blue-600 hover:text-blue-500",children:"이용약관"})," 및"," ",e.jsx("a",{href:"#",className:"text-blue-600 hover:text-blue-500",children:"개인정보처리방침"}),"에 동의합니다."]})]}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:u,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 cursor-pointer whitespace-nowrap disabled:opacity-50",children:u?"가입 중...":"회원가입"})})]})]})})]})}export{k as default};
