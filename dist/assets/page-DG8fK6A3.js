import{r as c,u as E,j as e,L as _}from"./index-Bk_cQ8f4.js";import{s as u,L}from"./Logo26Building-B9GX83Xw.js";function T(){const[g,w]=c.useState(null),[k,C]=c.useState(null),[h,f]=c.useState(!1),[y,j]=c.useState(""),[r,N]=c.useState(1),b=E(),[s,d]=c.useState({company_name:"",business_type:"",floor_number:"",room_number:"",move_in_date:"",contact_person:"",contact_phone:"",contact_email:"",employee_count:0,parking_needed:!1,parking_count:0,special_requests:""});c.useEffect(()=>{S()},[]);const S=async()=>{try{const{data:{user:a}}=await u.auth.getUser();if(!a){b("/login");return}w(a);const{data:t}=await u.from("profiles").select("*").eq("id",a.id).single();if(t){C(t);const i=a.user_metadata?.name||t.name||a.email?.split("@")[0]||"사용자",o=a.user_metadata?.phone||t.phone||"",n=t.email||a.email||"";console.log("Profile data loaded:",{metaName:i,metaPhone:o,metaEmail:n,userEmail:a.email}),d(x=>({...x,contact_person:i,contact_phone:o,contact_email:n}))}else{const i=a.user_metadata?.name||a.email?.split("@")[0]||"사용자",o=a.user_metadata?.phone||"",n=a.email||"";console.log("No profile, using auth data:",{metaName:i,metaPhone:o,metaEmail:n,userEmail:a.email}),d(x=>({...x,contact_person:i,contact_phone:o,contact_email:n}))}}catch(a){console.error("Error:",a)}},v=async a=>{a.preventDefault(),console.log("handleSubmit called, currentStep:",r),f(!0),j("");try{await u.from("profiles").upsert({id:g.id,name:s.contact_person,email:s.contact_email,phone:s.contact_phone,role:k?.role??"user",updated_at:new Date().toISOString()},{onConflict:"id"});const{error:t}=await u.from("move_in_cards").insert({user_id:g.id,...s});if(t)throw t;b("/dashboard")}catch(t){j(t.message||"입주카드 작성에 실패했습니다.")}finally{f(!1)}},l=a=>{const{name:t,value:i,type:o}=a.target;if(o==="checkbox"){const n=a.target.checked;d(x=>({...x,[t]:n}))}else d(o==="number"?n=>({...n,[t]:parseInt(i)||0}):n=>({...n,[t]:i}))},q=async()=>{await u.auth.signOut(),b("/")},F=()=>{r<4&&(N(r+1),window.scrollTo({top:0,behavior:"smooth"}))},I=()=>{r>1&&(N(r-1),window.scrollTo({top:0,behavior:"smooth"}))},p=()=>{switch(r){case 1:return!!(s.company_name&&s.business_type);case 2:return!!(s.floor_number&&s.room_number&&s.move_in_date);case 3:return!!(s.contact_person&&s.contact_phone&&s.contact_email);case 4:return!0;default:return!1}},m=[{number:1,title:"회사 정보",description:"기본적인 회사 정보를 입력해주세요",icon:"ri-building-line"},{number:2,title:"입주 정보",description:"입주 위치와 날짜를 입력해주세요",icon:"ri-map-pin-line"},{number:3,title:"담당자 정보",description:"담당자 연락처를 입력해주세요",icon:"ri-user-line"},{number:4,title:"추가 정보",description:"기타 필요한 정보를 입력해주세요",icon:"ri-information-line"}];return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50",children:[e.jsx("header",{className:"bg-white shadow-sm sticky top-0 z-10",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex justify-between items-center py-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(_,{to:"/",className:"flex items-center",children:e.jsx(L,{size:40})}),e.jsx("span",{className:"hidden sm:block text-gray-400",children:"|"}),e.jsx("span",{className:"hidden sm:block text-gray-600 font-medium",children:"입주카드 작성"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs(_,{to:"/dashboard",className:"text-gray-600 hover:text-gray-900 transition-colors flex items-center space-x-1",children:[e.jsx("i",{className:"ri-arrow-left-line"}),e.jsx("span",{className:"hidden sm:inline",children:"대시보드"})]}),e.jsxs("button",{onClick:q,className:"bg-gray-100 hover:bg-gray-200 text-gray-700 px-3 py-2 rounded-lg text-sm font-medium transition-all cursor-pointer",children:[e.jsx("i",{className:"ri-logout-box-line sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"로그아웃"})]})]})]})})}),e.jsxs("main",{className:"max-w-4xl mx-auto py-8 px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:m.map((a,t)=>e.jsxs("div",{className:"flex items-center flex-1",children:[e.jsxs("div",{className:"flex flex-col items-center flex-1",children:[e.jsx("div",{className:`
                    w-12 h-12 rounded-full flex items-center justify-center text-xl font-bold transition-all duration-300 mb-2
                    ${r===a.number?"bg-gradient-to-r from-blue-600 to-indigo-600 text-white shadow-lg scale-110":r>a.number?"bg-green-500 text-white shadow-md":"bg-gray-200 text-gray-500"}
                  `,children:r>a.number?e.jsx("i",{className:"ri-check-line"}):e.jsx("i",{className:a.icon})}),e.jsx("div",{className:"hidden md:block text-center",children:e.jsx("p",{className:`text-sm font-medium ${r>=a.number?"text-gray-900":"text-gray-500"}`,children:a.title})})]}),t<m.length-1&&e.jsx("div",{className:`
                    h-1 flex-1 mx-2 transition-all duration-300 rounded-full
                    ${r>a.number?"bg-green-500":"bg-gray-200"}
                  `})]},a.number))}),e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:m[r-1].title}),e.jsx("p",{className:"text-gray-600",children:m[r-1].description})]})]}),y&&e.jsx("div",{className:"mb-6 bg-red-50 border-l-4 border-red-500 text-red-700 px-6 py-4 rounded-lg shadow-sm animate-shake",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("i",{className:"ri-error-warning-line text-2xl mr-3"}),e.jsx("p",{className:"font-medium",children:y})]})}),e.jsx("div",{className:"bg-white rounded-2xl shadow-xl overflow-hidden",children:e.jsxs("form",{onSubmit:v,children:[r===1&&e.jsx("div",{className:"p-8 animate-fadeIn",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("label",{htmlFor:"company_name",className:"block text-sm font-semibold text-gray-700 mb-2",children:[e.jsx("i",{className:"ri-building-4-line mr-2 text-blue-600"}),"회사명 *"]}),e.jsx("input",{type:"text",name:"company_name",id:"company_name",required:!0,value:s.company_name,onChange:l,className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-gray-900 placeholder-gray-400",placeholder:"예: (주)테크컴퍼니"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("label",{htmlFor:"business_type",className:"block text-sm font-semibold text-gray-700 mb-2",children:[e.jsx("i",{className:"ri-briefcase-line mr-2 text-blue-600"}),"업종 *"]}),e.jsxs("select",{name:"business_type",id:"business_type",required:!0,value:s.business_type,onChange:l,className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-gray-900",children:[e.jsx("option",{value:"",children:"업종을 선택하세요"}),e.jsx("option",{value:"IT/소프트웨어",children:"IT/소프트웨어"}),e.jsx("option",{value:"제조업",children:"제조업"}),e.jsx("option",{value:"서비스업",children:"서비스업"}),e.jsx("option",{value:"금융업",children:"금융업"}),e.jsx("option",{value:"유통업",children:"유통업"}),e.jsx("option",{value:"교육업",children:"교육업"}),e.jsx("option",{value:"의료업",children:"의료업"}),e.jsx("option",{value:"건설업",children:"건설업"}),e.jsx("option",{value:"기타",children:"기타"})]})]}),s.business_type==="기타"&&e.jsxs("div",{className:"relative animate-fadeIn",children:[e.jsxs("label",{htmlFor:"business_type_other",className:"block text-sm font-semibold text-gray-700 mb-2",children:[e.jsx("i",{className:"ri-edit-line mr-2 text-blue-600"}),"상세 업종"]}),e.jsx("input",{type:"text",name:"business_type",id:"business_type_other",value:s.business_type==="기타"?"":s.business_type,onChange:l,className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-gray-900 placeholder-gray-400",placeholder:"업종을 직접 입력해주세요"})]})]})}),r===2&&e.jsx("div",{className:"p-8 animate-fadeIn",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("label",{htmlFor:"floor_number",className:"block text-sm font-semibold text-gray-700 mb-2",children:[e.jsx("i",{className:"ri-building-2-line mr-2 text-blue-600"}),"층수 *"]}),e.jsx("input",{type:"text",name:"floor_number",id:"floor_number",required:!0,value:s.floor_number,onChange:l,className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-gray-900 placeholder-gray-400",placeholder:"예: 5층"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("label",{htmlFor:"room_number",className:"block text-sm font-semibold text-gray-700 mb-2",children:[e.jsx("i",{className:"ri-door-line mr-2 text-blue-600"}),"호수 *"]}),e.jsx("input",{type:"text",name:"room_number",id:"room_number",required:!0,value:s.room_number,onChange:l,className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-gray-900 placeholder-gray-400",placeholder:"예: 501호"})]}),e.jsxs("div",{className:"relative md:col-span-2",children:[e.jsxs("label",{htmlFor:"move_in_date",className:"block text-sm font-semibold text-gray-700 mb-2",children:[e.jsx("i",{className:"ri-calendar-check-line mr-2 text-blue-600"}),"입주 예정일 *"]}),e.jsx("input",{type:"date",name:"move_in_date",id:"move_in_date",required:!0,value:s.move_in_date,onChange:l,min:new Date().toISOString().split("T")[0],className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-gray-900"})]})]})}),r===3&&e.jsx("div",{className:"p-8 animate-fadeIn",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("label",{htmlFor:"contact_person",className:"block text-sm font-semibold text-gray-700 mb-2",children:[e.jsx("i",{className:"ri-user-line mr-2 text-blue-600"}),"담당자명 *"]}),e.jsx("input",{type:"text",name:"contact_person",id:"contact_person",required:!0,value:s.contact_person,onChange:l,className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-gray-900 placeholder-gray-400",placeholder:"담당자 이름"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("label",{htmlFor:"contact_phone",className:"block text-sm font-semibold text-gray-700 mb-2",children:[e.jsx("i",{className:"ri-phone-line mr-2 text-blue-600"}),"연락처 *"]}),e.jsx("input",{type:"tel",name:"contact_phone",id:"contact_phone",required:!0,value:s.contact_phone,onChange:l,className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-gray-900 placeholder-gray-400",placeholder:"010-0000-0000"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("label",{htmlFor:"contact_email",className:"block text-sm font-semibold text-gray-700 mb-2",children:[e.jsx("i",{className:"ri-mail-line mr-2 text-blue-600"}),"이메일 *"]}),e.jsx("input",{type:"email",name:"contact_email",id:"contact_email",required:!0,value:s.contact_email,onChange:l,className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-gray-900 placeholder-gray-400",placeholder:"email@example.com"})]})]})}),r===4&&e.jsx("div",{className:"p-8 animate-fadeIn",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("label",{htmlFor:"employee_count",className:"block text-sm font-semibold text-gray-700 mb-2",children:[e.jsx("i",{className:"ri-group-line mr-2 text-blue-600"}),"직원 수"]}),e.jsx("input",{type:"number",name:"employee_count",id:"employee_count",min:"0",value:s.employee_count,onChange:l,className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-gray-900 placeholder-gray-400",placeholder:"0"})]}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 p-6 rounded-xl border-2 border-blue-100",children:[e.jsxs("div",{className:"flex items-start",children:[e.jsx("input",{id:"parking_needed",name:"parking_needed",type:"checkbox",checked:s.parking_needed,onChange:l,className:"h-5 w-5 text-blue-600 focus:ring-blue-500 border-gray-300 rounded cursor-pointer mt-1"}),e.jsxs("label",{htmlFor:"parking_needed",className:"ml-3 cursor-pointer flex-1",children:[e.jsxs("span",{className:"text-sm font-semibold text-gray-900 flex items-center",children:[e.jsx("i",{className:"ri-parking-box-line mr-2 text-blue-600 text-lg"}),"주차 공간이 필요합니다"]}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"주차 공간이 필요한 경우 체크해주세요"})]})]}),s.parking_needed&&e.jsxs("div",{className:"mt-4 animate-fadeIn",children:[e.jsxs("label",{htmlFor:"parking_count",className:"block text-sm font-semibold text-gray-700 mb-2",children:[e.jsx("i",{className:"ri-car-line mr-2 text-blue-600"}),"필요한 주차 대수 *"]}),e.jsx("input",{type:"number",name:"parking_count",id:"parking_count",min:"1",required:s.parking_needed,value:s.parking_count,onChange:l,className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-gray-900",placeholder:"주차 대수를 입력하세요"})]})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("label",{htmlFor:"special_requests",className:"block text-sm font-semibold text-gray-700 mb-2",children:[e.jsx("i",{className:"ri-message-3-line mr-2 text-blue-600"}),"특별 요청사항"]}),e.jsx("textarea",{name:"special_requests",id:"special_requests",rows:5,value:s.special_requests,onChange:l,className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-gray-900 placeholder-gray-400 resize-none",placeholder:`추가로 요청하실 사항이 있으시면 작성해주세요
예: 사무기기 설치, 인터넷 회선 등`,maxLength:500}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"최대 500자까지 입력 가능합니다"}),e.jsxs("p",{className:`text-sm font-medium ${s.special_requests.length>450?"text-red-600":"text-gray-600"}`,children:[s.special_requests.length,"/500"]})]})]})]})}),e.jsxs("div",{className:"bg-gray-50 px-8 py-6 flex justify-between items-center border-t border-gray-200",children:[e.jsxs("button",{type:"button",onClick:I,disabled:r===1,className:`
                  flex items-center space-x-2 px-6 py-3 rounded-xl font-semibold transition-all
                  ${r===1?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-white text-gray-700 hover:bg-gray-100 border-2 border-gray-200 hover:border-gray-300 shadow-sm hover:shadow"}
                `,children:[e.jsx("i",{className:"ri-arrow-left-line"}),e.jsx("span",{children:"이전"})]}),e.jsxs("div",{className:"hidden sm:flex items-center space-x-2 text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:r}),e.jsx("span",{children:"/"}),e.jsx("span",{children:m.length})]}),r<4?e.jsxs("button",{type:"button",onClick:F,disabled:!p(),className:`
                    flex items-center space-x-2 px-6 py-3 rounded-xl font-semibold transition-all
                    ${p()?"bg-gradient-to-r from-blue-600 to-indigo-600 text-white hover:from-blue-700 hover:to-indigo-700 shadow-lg hover:shadow-xl transform hover:scale-105":"bg-gray-300 text-gray-500 cursor-not-allowed"}
                  `,children:[e.jsx("span",{children:"다음"}),e.jsx("i",{className:"ri-arrow-right-line"})]}):e.jsx("button",{type:"button",onClick:a=>{console.log("Submit button clicked, currentStep:",r),v(a)},disabled:h||!p(),className:`
                    flex items-center space-x-2 px-8 py-3 rounded-xl font-semibold transition-all
                    ${h||!p()?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-gradient-to-r from-green-600 to-emerald-600 text-white hover:from-green-700 hover:to-emerald-700 shadow-lg hover:shadow-xl transform hover:scale-105"}
                  `,children:h?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-loader-4-line animate-spin"}),e.jsx("span",{children:"제출 중..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-send-plane-fill"}),e.jsx("span",{children:"입주카드 제출"})]})})]})]})}),e.jsx("div",{className:"mt-8 bg-gradient-to-r from-blue-100 to-indigo-100 rounded-xl p-6 border border-blue-200",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"bg-blue-600 rounded-full p-2 flex-shrink-0",children:e.jsx("i",{className:"ri-lightbulb-line text-white text-xl"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"도움말"}),e.jsxs("ul",{className:"space-y-1 text-sm text-gray-700",children:[e.jsxs("li",{className:"flex items-start",children:[e.jsx("i",{className:"ri-checkbox-circle-fill text-blue-600 mr-2 mt-0.5"}),e.jsx("span",{children:"모든 필수 항목(*)은 반드시 입력해야 합니다"})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("i",{className:"ri-checkbox-circle-fill text-blue-600 mr-2 mt-0.5"}),e.jsx("span",{children:"제출 후 관리자 승인이 완료되면 이메일로 알려드립니다"})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("i",{className:"ri-checkbox-circle-fill text-blue-600 mr-2 mt-0.5"}),e.jsx("span",{children:"문의사항은 관리자에게 연락해주세요"})]})]})]})]})})]}),e.jsx("style",{children:`
        @keyframes fadeIn {
          from {
            opacity: 0;
            transform: translateY(10px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        @keyframes shake {
          0%, 100% { transform: translateX(0); }
          25% { transform: translateX(-10px); }
          75% { transform: translateX(10px); }
        }

        .animate-fadeIn {
          animation: fadeIn 0.3s ease-out;
        }

        .animate-shake {
          animation: shake 0.5s ease-in-out;
        }
      `})]})}export{T as default};
