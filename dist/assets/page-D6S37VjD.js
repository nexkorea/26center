import{r as l,u as z,j as e,L as h}from"./index-BC6Ow5Dq.js";import{s as d,L as T}from"./Logo26Building-DPNVMLyf.js";function M(){const[$,N]=l.useState(null),[v,_]=l.useState(null),[w,k]=l.useState(!0),[m,c]=l.useState(""),[a,g]=l.useState(1),[f,j]=l.useState(!1),[C,S]=l.useState([]),[x,q]=l.useState(""),[s,b]=l.useState({company_name:"",business_type:"",floor_number:"",room_number:"",move_in_date:"",contact_person:"",contact_phone:"",contact_email:"",employee_count:1,parking_needed:!1,parking_count:0,special_requests:""}),p=z();l.useEffect(()=>{I()},[]);const I=async()=>{try{const{data:{user:r}}=await d.auth.getUser();if(!r){p("/login");return}N(r);const{data:n,error:o}=await d.from("profiles").select("*").eq("id",r.id).single();if(o)throw o;if(_(n),!n?.is_admin){c("관리자 권한이 필요합니다.");return}await L()}catch(r){console.error("사용자 확인 오류:",r),c("사용자 정보를 확인하는데 실패했습니다.")}finally{k(!1)}},L=async()=>{try{const{data:r,error:n}=await d.from("profiles").select("*").eq("is_admin",!1).order("name");if(n)throw n;S(r||[])}catch(r){console.error("프로필 로딩 오류:",r)}},t=r=>{const{name:n,value:o,type:y}=r.target;if(y==="checkbox"){const i=r.target.checked;b(F=>({...F,[n]:i}))}else b(y==="number"?i=>({...i,[n]:parseInt(o)||0}):i=>({...i,[n]:o}))},E=()=>{a<4&&g(a+1)},U=()=>{a>1&&g(a-1)},u=r=>{switch(r){case 1:return s.company_name&&s.business_type&&s.floor_number&&s.room_number&&s.move_in_date;case 2:return x;case 3:return s.contact_person&&s.contact_phone&&s.contact_email;case 4:return!0;default:return!1}},P=async()=>{if(!x){c("입주자를 선택해주세요.");return}try{j(!0),c("");const{data:r,error:n}=await d.from("move_in_cards").insert({user_id:x,company_name:s.company_name,business_type:s.business_type,floor_number:s.floor_number,room_number:s.room_number,move_in_date:s.move_in_date,contact_person:s.contact_person,contact_phone:s.contact_phone,contact_email:s.contact_email,employee_count:s.employee_count,parking_needed:s.parking_needed,parking_count:s.parking_count,special_requests:s.special_requests||null,status:"pending"});if(n)throw n;alert("입주카드가 성공적으로 작성되었습니다."),p("/admin")}catch(r){console.error("입주카드 작성 오류:",r),c("입주카드 작성에 실패했습니다.")}finally{j(!1)}},D=async()=>{await d.auth.signOut(),p("/")};return w?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100",children:e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"로딩 중..."})]})})}):m?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100",children:e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("i",{className:"ri-error-warning-line text-6xl text-red-500 mb-4"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"오류가 발생했습니다"}),e.jsx("p",{className:"text-gray-600 mb-6",children:m}),e.jsx("button",{onClick:()=>window.location.reload(),className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-medium transition-colors duration-200",children:"새로고침"})]})})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100",children:[e.jsx("header",{className:"bg-white shadow-sm",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex justify-between items-center py-6",children:[e.jsx(h,{to:"/",className:"flex items-center space-x-3",children:e.jsx(T,{size:40})}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(h,{to:"/admin",className:"text-gray-600 hover:text-gray-900 font-medium",children:"관리자 대시보드"}),e.jsx("span",{className:"text-gray-400",children:"|"}),e.jsx("span",{className:"text-gray-600",children:v?.name||"관리자"}),e.jsx("button",{onClick:D,className:"text-red-600 hover:text-red-700 font-medium",children:"로그아웃"})]})]})})}),e.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"관리자 입주카드 작성"}),e.jsx("p",{className:"text-gray-600",children:"입주자를 대신하여 입주카드를 작성합니다."})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:[1,2,3,4].map(r=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center text-sm font-medium ${a>=r?"bg-blue-600 text-white":"bg-gray-200 text-gray-600"}`,children:r}),r<4&&e.jsx("div",{className:`w-16 h-1 mx-2 ${a>r?"bg-blue-600":"bg-gray-200"}`})]},r))}),e.jsxs("div",{className:"flex justify-between text-sm text-gray-600",children:[e.jsx("span",{children:"기본 정보"}),e.jsx("span",{children:"입주자 선택"}),e.jsx("span",{children:"담당자 정보"}),e.jsx("span",{children:"추가 정보"})]})]}),m&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 mb-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("i",{className:"ri-error-warning-line text-red-500 mr-2"}),e.jsx("p",{className:"text-red-700 text-sm",children:m})]})}),e.jsxs("div",{className:"space-y-8",children:[a===1&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-6",children:"기본 정보"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["회사명 ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"company_name",value:s.company_name,onChange:t,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"회사명을 입력하세요"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["업종 ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{name:"business_type",value:s.business_type,onChange:t,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"업종을 선택하세요"}),e.jsx("option",{value:"IT/소프트웨어",children:"IT/소프트웨어"}),e.jsx("option",{value:"금융/보험",children:"금융/보험"}),e.jsx("option",{value:"제조업",children:"제조업"}),e.jsx("option",{value:"서비스업",children:"서비스업"}),e.jsx("option",{value:"기타",children:"기타"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["층수 ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"floor_number",value:s.floor_number,onChange:t,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"예: 5층"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["호수 ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"room_number",value:s.room_number,onChange:t,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"예: 501호"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["입주 예정일 ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"date",name:"move_in_date",value:s.move_in_date,onChange:t,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]})]}),a===2&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-6",children:"입주자 선택"}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["입주자 ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:x,onChange:r=>q(r.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"입주자를 선택하세요"}),C.map(r=>e.jsxs("option",{value:r.id,children:[r.name," (",r.email,")"]},r.id))]}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"입주자를 대신하여 입주카드를 작성합니다."})]})]}),a===3&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-6",children:"담당자 정보"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["담당자명 ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"contact_person",value:s.contact_person,onChange:t,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"담당자명을 입력하세요"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["연락처 ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"tel",name:"contact_phone",value:s.contact_phone,onChange:t,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"010-1234-5678"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["이메일 ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"email",name:"contact_email",value:s.contact_email,onChange:t,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"contact@company.com"})]})]})]}),a===4&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-6",children:"추가 정보"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"직원 수"}),e.jsx("input",{type:"number",name:"employee_count",value:s.employee_count,onChange:t,min:"1",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"주차 필요 여부"}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",name:"parking_needed",checked:s.parking_needed,onChange:t,className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"주차 필요"})]})})]}),s.parking_needed&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"주차 대수"}),e.jsx("input",{type:"number",name:"parking_count",value:s.parking_count,onChange:t,min:"0",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"특별 요청사항"}),e.jsx("textarea",{name:"special_requests",value:s.special_requests,onChange:t,rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",placeholder:"특별한 요청사항이 있다면 입력하세요"})]})]})]})]}),e.jsxs("div",{className:"flex justify-between mt-8",children:[e.jsx("button",{type:"button",onClick:U,disabled:a===1,className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-xl font-medium hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200",children:"이전"}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx(h,{to:"/admin",className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-xl font-medium hover:bg-gray-50 transition-colors duration-200",children:"취소"}),a<4?e.jsx("button",{type:"button",onClick:E,disabled:!u(a),className:"px-6 py-3 bg-blue-600 text-white rounded-xl font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200",children:"다음"}):e.jsx("button",{type:"button",onClick:P,disabled:f||!u(1)||!u(2)||!u(3),className:"px-6 py-3 bg-green-600 text-white rounded-xl font-medium hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200 flex items-center gap-2",children:f?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"작성 중..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-check-line"}),"입주카드 작성"]})})]})]})]})})]})}export{M as default};
