import{a as k,u as _,b as C,r as t,j as e,L as d}from"./index-BNhxf-S_.js";import{s as o,L}from"./Logo26Building-SbgR5LEQ.js";function q(){const{id:l}=k(),g=_();C();const[s,p]=t.useState(null),[S,b]=t.useState(null),[u,m]=t.useState(!0),[h,j]=t.useState(""),[i,N]=t.useState(!1);t.useEffect(()=>{l&&f()},[l]);const f=async()=>{try{const{data:{user:a}}=await o.auth.getUser();if(!a){g("/login");return}const{data:x}=await o.from("profiles").select("role").eq("id",a.id).single(),r=x?.role==="admin";N(r),await y(a.id,r)}catch(a){console.error("Error checking user:",a),j("사용자 인증에 실패했습니다."),m(!1)}},y=async(a,x)=>{try{console.log("Loading move-in card:",{id:l,userId:a,isUserAdmin:x});let r=o.from("move_in_cards").select(`
          *,
          profiles(name, email, phone)
        `).eq("id",l);x||(r=r.eq("user_id",a));const{data:c,error:n}=await r.single();if(console.log("Query result:",{data:c,error:n}),n)throw console.error("Database error:",n),n.code==="PGRST116"?new Error("입주카드를 찾을 수 없습니다."):n;if(!c)throw new Error("입주카드를 찾을 수 없습니다.");console.log("Move-in card loaded successfully:",c),p(c),b(c.profiles)}catch(r){console.error("Error loading move-in card:",r),j(r.message||"입주카드를 불러오는데 실패했습니다.")}finally{m(!1)}},v=a=>{switch(a){case"approved":return"bg-green-100 text-green-800 border-green-200";case"rejected":return"bg-red-100 text-red-800 border-red-200";case"pending":default:return"bg-yellow-100 text-yellow-800 border-yellow-200"}},w=a=>{switch(a){case"approved":return"승인됨";case"rejected":return"반려됨";case"pending":default:return"대기중"}};return u?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("i",{className:"ri-loader-4-line animate-spin text-4xl text-blue-600 mb-4"}),e.jsx("p",{className:"text-gray-600",children:"입주카드를 불러오는 중..."})]})}):h||!s?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center max-w-md mx-auto px-4",children:[e.jsx("i",{className:"ri-error-warning-line text-6xl text-red-500 mb-4"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"오류 발생"}),e.jsx("p",{className:"text-gray-600 mb-4",children:h||"입주카드를 찾을 수 없습니다."}),e.jsxs("div",{className:"text-sm text-gray-500 mb-6",children:[e.jsxs("p",{children:["• 입주카드 ID: ",l]}),e.jsx("p",{children:"• 권한이 없거나 입주카드가 존재하지 않을 수 있습니다."})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[e.jsxs(d,{to:"/dashboard",className:"inline-flex items-center space-x-2 px-6 py-3 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-colors",children:[e.jsx("i",{className:"ri-arrow-left-line"}),e.jsx("span",{children:"대시보드로 돌아가기"})]}),e.jsxs("button",{onClick:()=>window.location.reload(),className:"inline-flex items-center space-x-2 px-6 py-3 bg-gray-600 text-white rounded-xl hover:bg-gray-700 transition-colors",children:[e.jsx("i",{className:"ri-refresh-line"}),e.jsx("span",{children:"새로고침"})]})]})]})}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white border-b border-gray-200",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex items-center justify-between h-16",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(d,{to:"/",className:"flex items-center",children:e.jsx(L,{size:40})}),e.jsx("span",{className:"hidden sm:block text-gray-400",children:"|"}),e.jsx("span",{className:"hidden sm:block text-gray-600 font-medium",children:"입주카드 상세"})]}),e.jsx("div",{className:"flex items-center space-x-3",children:e.jsxs(d,{to:i?"/admin":"/dashboard",className:"text-gray-600 hover:text-gray-900 transition-colors flex items-center space-x-1",children:[e.jsx("i",{className:"ri-arrow-left-line"}),e.jsx("span",{className:"hidden sm:inline",children:i?"관리자 페이지":"대시보드"})]})})]})})}),e.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 px-8 py-6 text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:s.company_name}),e.jsx("p",{className:"text-blue-100",children:s.business_type})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:`inline-flex items-center px-4 py-2 rounded-full text-sm font-medium border ${v(s.status)}`,children:[e.jsx("i",{className:"ri-checkbox-circle-line mr-2"}),w(s.status)]}),e.jsxs("p",{className:"text-blue-100 text-sm mt-2",children:["신청일: ",new Date(s.created_at).toLocaleDateString("ko-KR")]})]})]})}),e.jsxs("div",{className:"p-8",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 flex items-center",children:[e.jsx("i",{className:"ri-building-line mr-3 text-blue-600"}),"회사 정보"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"회사명"}),e.jsx("p",{className:"text-gray-900 font-medium",children:s.company_name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"업종"}),e.jsx("p",{className:"text-gray-900",children:s.business_type})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"직원 수"}),e.jsxs("p",{className:"text-gray-900",children:[s.employee_count,"명"]})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 flex items-center",children:[e.jsx("i",{className:"ri-map-pin-line mr-3 text-blue-600"}),"입주 정보"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"층수"}),e.jsxs("p",{className:"text-gray-900 font-medium",children:[s.floor_number,"층"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"호수"}),e.jsxs("p",{className:"text-gray-900",children:[s.room_number,"호"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"입주 예정일"}),e.jsx("p",{className:"text-gray-900",children:new Date(s.move_in_date).toLocaleDateString("ko-KR")})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 flex items-center",children:[e.jsx("i",{className:"ri-user-line mr-3 text-blue-600"}),"담당자 정보"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"담당자명"}),e.jsx("p",{className:"text-gray-900 font-medium",children:s.contact_person})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"연락처"}),e.jsx("p",{className:"text-gray-900",children:s.contact_phone})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"이메일"}),e.jsx("p",{className:"text-gray-900",children:s.contact_email})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 flex items-center",children:[e.jsx("i",{className:"ri-car-line mr-3 text-blue-600"}),"주차 정보"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"주차 필요"}),e.jsx("p",{className:"text-gray-900",children:s.parking_needed?e.jsxs("span",{className:"inline-flex items-center text-green-600",children:[e.jsx("i",{className:"ri-check-line mr-1"}),"필요함"]}):e.jsxs("span",{className:"inline-flex items-center text-gray-500",children:[e.jsx("i",{className:"ri-close-line mr-1"}),"불필요"]})})]}),s.parking_needed&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"주차 공간 수"}),e.jsxs("p",{className:"text-gray-900",children:[s.parking_count,"개"]})]})]})]})]}),s.special_requests&&e.jsxs("div",{className:"mt-8 pt-8 border-t border-gray-200",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 flex items-center mb-4",children:[e.jsx("i",{className:"ri-message-3-line mr-3 text-blue-600"}),"특별 요청사항"]}),e.jsx("div",{className:"bg-gray-50 rounded-xl p-6",children:e.jsx("p",{className:"text-gray-900 whitespace-pre-wrap",children:s.special_requests})})]}),s.admin_notes&&e.jsxs("div",{className:"mt-8 pt-8 border-t border-gray-200",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 flex items-center mb-4",children:[e.jsx("i",{className:"ri-admin-line mr-3 text-blue-600"}),"관리자 메모"]}),e.jsx("div",{className:"bg-blue-50 rounded-xl p-6",children:e.jsx("p",{className:"text-gray-900 whitespace-pre-wrap",children:s.admin_notes})})]}),e.jsxs("div",{className:"mt-8 pt-8 border-t border-gray-200 flex justify-between items-center",children:[e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs(d,{to:i?"/admin":"/dashboard",className:"px-6 py-3 bg-gray-100 text-gray-700 rounded-xl hover:bg-gray-200 transition-colors flex items-center space-x-2",children:[e.jsx("i",{className:"ri-arrow-left-line"}),e.jsx("span",{children:i?"관리자 페이지로":"목록으로"})]}),e.jsxs("button",{onClick:()=>window.print(),className:"px-6 py-3 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[e.jsx("i",{className:"ri-printer-line"}),e.jsx("span",{children:"인쇄"})]})]}),i&&s.status==="pending"&&e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("button",{onClick:()=>{console.log("승인 처리:",s.id)},className:"px-6 py-3 bg-green-600 text-white rounded-xl hover:bg-green-700 transition-colors flex items-center space-x-2",children:[e.jsx("i",{className:"ri-check-line"}),e.jsx("span",{children:"승인"})]}),e.jsxs("button",{onClick:()=>{console.log("반려 처리:",s.id)},className:"px-6 py-3 bg-red-600 text-white rounded-xl hover:bg-red-700 transition-colors flex items-center space-x-2",children:[e.jsx("i",{className:"ri-close-line"}),e.jsx("span",{children:"반려"})]})]})]})]})]})})]})}export{q as default};
